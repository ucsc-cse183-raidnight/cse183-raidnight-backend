[[extend 'layout.html']]

<div class="session">
    <div class="title">
        <h1 class="title is-size-3">Session: [[=game_session.name]]</h1>
    </div>


    <div class="block mt-3 mx-6">
        [[if user == game_session.owner_id:]]
        <div class="level-right">
            <div class="field has-addons">
                <div class="control">
                    <input type="text" class="input invite-link" value="" id="url">
                </div>
                <div class="control tooltip">
                    <button class="button is-primary is-small copy" onclick="copy()" onmouseout="out()">
                            <span class="tooltiptext" id="copyTooltip">
                                Copy invite link
                            </span>
                        <span class="icon mr-1">
                                <i class="far fa-copy"></i>
                            </span>
                    </button>
                </div>
            </div>
        </div>
        [[pass]]

        <table>
            <tbody>

            <tr>
                <td class="c1">
                    <span>Description: </span>
                </td>
                <td class="c2">
                    [[=game_session.description]]
                </td>
            </tr>
            <tr>
                <td class="c1">
                    <span>Signups: </span>
                </td>
                <td class="c2">
                    [[for signup in signups:]]
                    <div class="level">
                        <div class="level-left">
                            [[if signup.user_id:]]
                            <p>[[=signup.user_id]]</p>
                            [[else:]]
                            <p>[[=signup.anonymous_name]]</p>
                            [[pass]]
                        </div>
                        [[if user == signup.user_id:]]
                        <div class="level-right ml-3">
                            <a class="button is-primary is-small edit-signup" style="border-radius: 13px"
                               href="[[=URL('sessions', session_id, 'edit_signup', signup.id)]]">
                                edit signup
                            </a>
                        </div>
                        [[pass]]
                    </div>
                    [[pass]]
                </td>
            </tr>

            </tbody>
        </table>


        <div class="mt-3 level-right">
            [[if user == game_session.owner_id:]]
            <a class="button is-primary" href="[[=URL('sessions', session_id, 'edit')]]">
                Edit Session
            </a>
            <a class="button is-primary ml-2" href="[[=URL('sessions', session_id, 'delete')]]">
                Delete Session
            </a>
            [[pass]]
        </div>
    </div>

</div>
<script>
    let url = new URL("../invite/[[=key]]", document.baseURI).href;
    console.log(url)
    document.getElementById("url").value = url;

    function copy() {
        let copyUrl = document.getElementById("url");
        copyUrl.select();
        document.execCommand("copy");
        let tooltip = document.getElementById("copyTooltip")
        tooltip.innerHTML = "Copied";
    }

    function out() {
        let tooltip = document.getElementById("copyTooltip")
        tooltip.innerHTML = "Copy invite link";
    }
</script>